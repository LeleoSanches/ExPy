%% AMS-LaTeX Created with the Wolfram Language : www.wolfram.com

\documentclass{article}
\usepackage{amsmath, amssymb, graphics, setspace}

\newcommand{\mathsym}[1]{{}}
\newcommand{\unicode}[1]{{}}

\newcounter{mathematicapage}
\begin{document}

\begin{doublespace}
\noindent\(\pmb{\text{data} = \text{Import}[\text{{``}C: 1090.dat{''}}];}\\
\pmb{\text{RC}=\text{Table}[\{\text{data}[[i,1]],\text{data}[[i,3]]\},\{i,1,24\}];}\\
\pmb{\text{Rgas}=\text{Table}[\{\text{data}[[i,1]],\text{data}[[i,4]]\},\{i,1,24\}];}\\
\pmb{\text{Erro} = \text{Table}[\text{data}[[i,5]],\{i,1,24\}];}\\
\pmb{\text{TableForm}[\text{data},\text{TableHeadings}\to \{\{\text{{``}NGC 1090{''}}\},\{\text{{``}Raio{''}},\text{{``}{''}},\text{{``}Vtotal{''}},\text{{``}Vgas{''}},\text{{``}Erro{''}}\}\}];}\)
\end{doublespace}

\begin{doublespace}
\noindent\(\pmb{\text{Vgas} = \text{Interpolation}[\text{Rgas}]}\\
\pmb{\text{Vd}[\text{r$\_$},\text{M$\_$}]\text{:=}\frac{\left(G \left(M 10^9\right) \left(\frac{r}{\text{Rd}}\right)^2\right) \left(\text{BesselI}\left[0,\frac{r}{2
\text{Rd}}\right] \text{BesselK}\left[0,\frac{r}{2 \text{Rd}}\right]-\text{BesselI}\left[1,\frac{r}{2 \text{Rd}}\right] \text{BesselK}\left[1,\frac{r}{2
\text{Rd}}\right]\right)}{2 \text{Rd}};}\\
\pmb{\text{Vme}[\text{r$\_$},\text{R$\_$},\text{P$\_$}]\text{:=}\frac{6.4 G \left(\left(P 10^7\right) R^3\right) \left(\frac{1}{2} \text{Log}\left[\left(\frac{r}{R}\right)^2+1\right]+\text{Log}\left[\frac{r}{R}+1\right]-\text{ArcTan}\left[\frac{r}{R}\right]\right)}{r};}\\
\pmb{G\text{:=}\frac{4.302}{10^6};}\\
\pmb{\text{Rd}\text{:=}3.4;}\\
\pmb{\text{Vt}[\text{r$\_$},\text{M$\_$},\text{R$\_$},\text{P$\_$}]\text{:=}\sqrt{\text{Vd}[r,M]+\text{Vme}[r,R,P]+\text{Vgas}[r]^2}}\)
\end{doublespace}

\begin{doublespace}
\noindent\(\pmb{\text{Ajuste}= \text{NonlinearModelFit}[\text{RC},\text{Vt}[r,M,R,P],\{\{R,1,50\},\{P,1,10\},\{M,1,50\}\},r,\text{Weights}\to 1/\text{Erro}{}^{\wedge}2]}\\
\pmb{\text{Ajuste}[\text{{``}ParameterTable{''}}]}\)
\end{doublespace}

\begin{doublespace}
\noindent\(\pmb{\text{Needs}[\text{{``}ErrorBarPlots$\grave{ }${''}}]}\)
\end{doublespace}

\begin{doublespace}
\noindent\(\pmb{\text{}}\\
\pmb{\text{Gas} =\text{Plot}[\text{Igas}[\unicode{f817}],\{\unicode{f817},\text{{``}0.27931{''}},29.2\},\text{PlotStyle}\to \{\text{Black},\text{Dashed}\},\text{AxesLabel}\to
\{\text{{``}R(Kpc){''}},\text{{``}V(Km/s){''}}\}];}\\
\pmb{\text{Vstars} = \text{Plot}[\text{Sqrt}[\text{Vd}[r,M]]\text{/.}M\to 36.5,\{r,0,29.4\}, \text{PlotStyle}\to \{\text{Black},\text{Dotted}\}];}\\
\pmb{\text{Vhalo} = \text{Plot}[\text{Sqrt}[\text{Vme}[r,R,P]]\text{/.}\{R\to 7.8,P\to 2.3\},\{r,0,29.4\},\text{PlotStyle}\to \{\text{Black},\text{DotDashed}\}];}\\
\pmb{\text{VRC} = \text{ErrorListPlot}[\{\text{Table}[\{\text{RC}[[i]],\text{ErrorBar}[\text{Erro}[[i]]]\},\{i,24\}]\}, \\ \text{PlotStyle}\to \text{Black},\text{MeshStyle}\to
\text{PointSize}[\text{Large}]];}\\
\pmb{\text{RCtotal} = \text{Plot}[\text{Vt}[r,M,R,P]\text{/.}\{M\to 36.5,R\to 7.8,P\to 2.3\},\{r,0,29.4\},\text{PlotStyle}\to \\  \text{Black},\text{PlotRange}\to
\{\{0,30\},\{0,190\}\}];}\)
\end{doublespace}

\begin{doublespace}
\noindent\(\pmb{\text{Show}[\text{RCtotal},\text{VRC},\text{Vstars},\text{Vhalo},\text{Gas}, \text{Frame}\to \text{True}, \\ \text{PlotRange}\to \{\{0,30\},\{0,190\}\},\text{PlotLabel}\to
\text{{``}NGC 1090{''}},}\\
\pmb{\text{FrameLabel}\to \{\text{{``}R(Kpc){''}},\text{{``}V(Km/s){''}}\}];}\\
\pmb{\text{ErrorListPlot}[\{\text{Table}[\{\text{Table}[\{\text{data}[[i,1]],\text{Ajuste}[\text{{``}FitResiduals{''}}][[i]]\},\{i,26\}][[i]],\text{ErrorBar}[\text{Erro}[[i]]]\}, \\ \{i,24\}]\},
}\\
\pmb{\text{PlotStyle}\to \text{Black}, \text{MeshStyle}\to \text{PointSize}[\text{Large}], \text{PlotRange}\to \{-40,20\}, \\ \text{Frame}\to \text{True},
\text{AspectRatio}\to 0.2];}\)
\end{doublespace}

\end{document}
